<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title>
</head>
<body>
<script>
'use strict';
/**
 *	Ajax与Comet
 *
 */

 /* XMLHttpRequest 对象 */

 var xhr = new XMLHttpRequest();
 console.log(xhr);

 // XHR的用法
 xhr.onreadystatechange = function(){
  if(xhr.readyState==4){
      if((xhr.status>=200 && xhr.status<300) || xhr.status==304){
        console.log(xhr.responseText);
      }else{
        console.log('Request was unsuccessful:'+xhr.status);
      }
  }
 }
 xhr.open('get','example.php',false);
 xhr.send(null);

 // HTTP头部信息
 // setRequestHeader("myheader","myvalue"): 设置自定义请求头信息
 // getRequestHeader("myheader"): 取得相应响应头部信息 
 // getAllRequestHeaders(): 取得包含所有头部信息的长字符串

 // GET请求

 // POST请求



  /* XMLHttpRequest2级 */

  // FormData 序列化
  var data = new FormData();
  data.append('name','Nicholas');
  console.log(data);

  // 超时设定
  xhr.timeout = 1000;
  xhr.ontimeout = function(){
    console.log('Request did not return in a second.');
  }

  // overrideMimeType("text/xml") 方法





  /* 进度事件 */

  // load事件
  // progress事件




  /* 跨源资源共享 */

  // IE对CORS的实现
  // 其他浏览器对CORS的实现
  // Preflighted Reqeusts
  // 带凭据的请求
  // 跨浏览器的CORS
  function createCORSRequest(method,url){
    var xhr = new XMLHttpRequest();
    if('withCredentials' in xhr){
      xhr.open(method,url,true);
    }else if(typeof XDomainRequest != 'undefined'){
      xhr = new XDomainRequest();
      xhr.open(method,url);
    }else{
      xhr = null;
    }
    return xht;
  }
  // 使用
  var request = createCORSRequest('get','http://www.somewhere-else.com/page/');
  if(request){
    request.onload = function(){
      // 对request.responseText进行处理
    };
    request.send();
  }





  /* 其他跨域技术 */

  // 图像Ping
  // JSONP
  // Comet
  // 服务器发送事件
  // Web Sockets
  // SSE 与 Web Sockets




  /* 安全 */




</script>
</body>
</html>