<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title></title>
</head>
<body>
<script>
'use strict';
/**
 *	高级技巧
 *
 */

 /* 高级函数 */

 // 安全的类型检测
 function isArray(value){
  return Object.prototype.toString.call(value) == '[object Array]';
 }
 function isFunction(value){
  return Object.prototype.toString.call(value) == '[object Function]';
 }
 function isRegExp(value){
  return Object.prototype.toString.call(value) == '[object Regexp]';
 }


 // 作用域安全的构造函数
 function Person(name,age,job){
  if(this instanceof Person){
    this.name = name;
    this.age = age;
    this.job = job;

  }else{
    return new Person(name,age,job);

  }
 }
 var person1 = Person('Nichoalas',29,'software engineer');
 var person1 = Person('Nichoalas',29,'software engineer');


 // 惰性载入函数 
 // 第一次调用的过程中，该函数会被覆盖为另外一个按格式方式执行的函数，这样任何对原函数的调用都不用再经过执行的分支了。

 var createXHR = (function(){
  if(typeof XMLHttpRequest != 'undefined'){
    return function(){
      console.log(1);
      return new XMLHttpRequest();
    }

  }else if(typeof ActivexObject != 'undefined'){
    return function(){
      // ....
      return 1;
    }

  }else{
    return function(){
      throw new Error('no xhr object available.');
    }

  }
 })();
 createXHR();


 // 函数绑定

 // 问题：
 var handler = {
  message:'event handled',
  handleClick:function(){
    console.log(this.message);
  }
 }
 var btn = document.getElementById('myBtn');
 btn.addEventListener('click',function(event){

  // 预期输出 event handled，但是this被改变指向 指向DOM按钮找不到message所有输出undefined
  handled.handleClick(event);

 },false);


 // 修改(定义一个bind函数)：
 function bind(fn,context){
  return function(){
    return fn.apply(context,arguments);
  }
 }
 // 使用修改：
 btn.addEventListener('click',bind(handler.handleClick,handler),false);

 // 使用js原声提供的bind()函数
 btn.addEventListener('click',handler.handleClick.bind(handler),false);



 // 函数柯里化
 function curry(fn){
  var args = Array.prototype.slice.call(arguments,1);
  return function(){
    var innerArgs = Array.prototype.slice.call(arguments);
    var finalArgs = args.concat(innerArgs);
    return fn.apply(null,finalArgs);
  }
 }





  /* 防篡改对象 */

  // 不可扩展对象
  



</script>
</body>
</html>